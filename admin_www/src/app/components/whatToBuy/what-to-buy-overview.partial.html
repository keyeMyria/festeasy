<loading-indicator data="orderProducts && festivals && stockUnits" error="error"></loading-indicator>
<div ng-if="orderProducts && festivals && stockUnits">
	For Festival:
	<ui-select ng-model="selectedFestival" on-select="updateSelectedFestival($item, $model)">
	    <ui-select-match placeholder="Select a festival">
	        <span ng-bind="$select.selected.name + ' ' + ($select.selected.starts_on | date: 'yyyy')"></span>
	    </ui-select-match>
	    <ui-select-choices repeat="festival in (festivals | filter: $select.search) track by festival.id">
	        <span ng-bind="festival.name + ' ' + (festival.starts_on | date: 'yyyy')"></span>
	    </ui-select-choices>
	</ui-select>
	<br/>
	<div ng-show="!orderProducts.length" class="text-center">
		<p class="lead">
			No results
		</p>
	</div>
	<table ng-show="orderProducts.length" class="table table-bordered table-hover">
			<tr>
				<th>Product</th>
				<th>Wanted</th>
				<th>Packaged</th>
				<th>Availiable In Stock</th>
			<tr>
	  	<tr ng-class="{'warning': (countStockUnits(value[0].product, stockUnits) < sumOrderProductQuantities(orderProducts)[key])}" ng-repeat="(key, value) in orderProducts | groupBy: 'product.id'">
	    	<td>{{value[0].product.name}}</td>
	    	<td>{{sumOrderProductQuantities(orderProducts)[key]}}</td>
				<td>Unknown</td>
				<td>{{countStockUnits(value[0].product, stockUnits)}}
	  	</tr>
	</table>
</div>
